defmodule RustyCrypt.Hashing.Sha3Test do
  use ExUnit.Case, async: true
  doctest RustyCrypt.Hashing.Sha3

  alias RustyCrypt.Hashing.Sha3

  test "sha224" do
    expected =
      <<227, 140, 243, 55, 228, 140, 219, 75, 100, 167, 70, 185, 148, 190, 32, 120, 30, 81, 244,
        84, 122, 76, 57, 36, 5, 153, 220, 186>>

    assert expected == Sha3.sha224(<<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
    assert expected == :crypto.hash(:sha3_224, <<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
  end

  test "sha256" do
    expected =
      <<96, 90, 5, 20, 5, 145, 146, 226, 109, 191, 6, 207, 171, 134, 243, 233, 187, 185, 166, 147,
        99, 212, 190, 146, 91, 34, 70, 220, 216, 101, 154, 149>>

    assert expected == Sha3.sha256(<<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
    assert expected == :crypto.hash(:sha3_256, <<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
  end

  test "sha384" do
    expected =
      <<67, 210, 32, 131, 127, 85, 184, 160, 5, 140, 87, 40, 224, 37, 93, 192, 176, 7, 90, 108,
        230, 157, 95, 202, 112, 75, 206, 92, 218, 225, 137, 99, 77, 102, 11, 115, 109, 123, 199,
        27, 50, 206, 218, 108, 204, 239, 142, 222>>

    assert expected == Sha3.sha384(<<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
    assert expected == :crypto.hash(:sha3_384, <<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
  end

  test "sha512" do
    expected =
      <<60, 82, 73, 212, 216, 20, 160, 236, 203, 50, 105, 245, 2, 79, 59, 207, 16, 39, 132, 224,
        67, 160, 106, 106, 106, 155, 203, 253, 32, 247, 83, 187, 252, 93, 160, 128, 142, 52, 248,
        131, 109, 244, 40, 171, 159, 37, 65, 223, 236, 179, 109, 242, 136, 17, 44, 224, 38, 137,
        2, 219, 229, 16, 89, 142>>

    assert expected == Sha3.sha512(<<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
    assert expected == :crypto.hash(:sha3_512, <<0, 1, 2, 3, 4, 5, 6, 7, 8, 9>>)
  end
end
